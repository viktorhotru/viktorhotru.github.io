!function() {
    "use strict";
    function e(t, n, i) {
        for (var o, a, s, r = 0, l = t.cssRules.length, d = void 0, c = void 0; r < l; ) {
            if ((d = t.cssRules[r]).type === d.STYLE_RULE) {
                for (o = ["animationName", "webkitAnimationName", "msAnimationName", "oAnimationName", "mozAnimationName"],
                         a = 0; a < o.length; a++)
                    if (d.style[o[a]]) {
                        if (0 === d.style[o[a]].indexOf(i))
                            continue;
                        d.style[o[a]] = i + d.style[o[a]]
                    }
                c = n + " " + (s = d.selectorText.replace(/,/g, ", " + n + " ")) + " {" + d.style.cssText + "}",
                    t.deleteRule(r),
                    t.insertRule(c, r)
            } else
                d.type === d.KEYFRAMES_RULE || d.type === d.WEBKIT_KEYFRAMES_RULE || d.type === d.MOZ_KEYFRAMES_RULE || d.type === d.MS_KEYFRAMES_RULE ? d.name = i + d.name : d.cssRules && d.cssRules.length ? e(d, n, i) : d.type === d.IMPORT_RULE && (t.deleteRule(r),
                    r--,
                    l--);
            r++
        }
    }
    function t(e, n, i) {
        var o, a, s, r, l, d, c, u = this;
        if (e.length) {
            for (a = (o = e.shift()).hasAttribute("src"),
                     s = document.createElement("script"),
                     r = function() {
                         t.call(u, e, n, i)
                     }
                     ,
                     l = function() {
                         if (-1 !== i) {
                             var e = xe.call(u);
                             ke.call(u, s, r.bind(u), e)
                         } else
                             r();
                         Se.call(u)
                     }
                     ,
                     s.addEventListener("load", l),
                     s.addEventListener("error", l),
                     d = o.attributes,
                     c = 0; c < d.length; c++)
                s.setAttribute(d[c].name, d[c].value);
            a || s.setAttribute("src", "data:text/javascript;base64," + btoa(encodeURIComponent(o.innerHTML).replace(/%([0-9A-F]{2})/g, function(e, t) {
                return String.fromCharCode("0x" + t)
            }))),
                s.innerHTML = o.innerHTML,
                We.call(u, function() {
                    -1 !== i && Ce.call(u, s),
                        o.parentNode.replaceChild(s, o)
                }, !0 === i)
        } else
            n && n()
    }
    function n() {
        var e = this
            , t = e.positionsQueue.shift();
        e.positionsQueueActive = !0,
            t(function() {
                0 === e.positionsQueue.length ? e.positionsQueueActive = !1 : n.call(e)
            })
    }
    function i() {
        var e = this
            , t = e.documentWatchers.shift();
        try {
            t.call(e),
            e.documentWatchers.length && i.call(e)
        } catch (e) {}
    }
    function o(e, t, n) {
        var i, a, s, r = this;
        if (0 !== e.length)
            if (n = n || {},
            "auto" === (i = e[0]).mode && "native" !== i.type)
                Ae.call(r, e, n);
            else if ("external-js" === i.mode && t)
                Ue.call(r, i, n.element),
                    Ae.call(r, e, n);
            else {
                if (("auto" === i.mode || "system" === i.mode) && "native" === i.type) {
                    if (!n || !n.selectors && !n.element)
                        return a = tt.call(r, W),
                            void Te.call(r, function() {
                                R.call(r, r.nativeWrapperPlugin)(a)
                            });
                    if (e.length > 1)
                        return void e.map(function(e) {
                            var t = n.selectors[r.segmentData["device_type"]];
                            t && t[e.placement] && (e.mode = "selector",
                                e.meta = t[e.placement],
                                o.call(r, [e], !1, n))
                        })
                }
                switch ("html-markup" === i.mode && (i.mode = "selector",
                    i.meta = ".hpmds-position-" + i.id),
                    i.mode) {
                    case "internal-js":
                    case "system":
                        t ? ("internal-js" === i.mode && Ue.call(r, i, n.element),
                            Ae.call(r, e, n)) : (s = {
                            ready: function(t) {
                                n.element = t,
                                    o.call(r, e, !0, n)
                            },
                            requestBanners: Be.bind(r)
                        },
                            R.call(r, i.meta)(s));
                        break;
                    case "selector":
                        Te.call(r, function() {
                            var t, o, a = [].slice.call(document.querySelectorAll(i.meta));
                            for (t = 0; t < a.length; t++)
                                i.already && !i.multi || a[t].querySelector(".hpmds-slot") || ((o = Me(n)).element = a[t],
                                    Ue.call(r, i, a[t]),
                                    Ae.call(r, e, o),
                                    i.already = !0)
                        });
                        break;
                    case "scroll":
                        Oe.call(r, e, n, function() {
                            window.addEventListener("scroll", function t() {
                                window.pageYOffset > 1.2 * window.innerHeight && (window.removeEventListener("scroll", t),
                                    De.call(r, e, n))
                            })
                        })
                }
            }
    }
    function a(e, t) {
        S.call(this, {
            forceAsync: !0,
            data: {
                method: "ad.banner.stories",
                data: {
                    banner_id: e.id,
                    view_id: this.viewId,
                    uid: this.uid,
                    hash: e.view.hash,
                    buffer_id: e.view.id
                }
            },
            success: function() {
                t(this.json.data)
            }
        })
    }
    function s(e, t) {
        S.call(this, {
            forceAsync: !0,
            data: {
                method: "ad.banner.highlights",
                data: {
                    banner_id: e.id,
                    view_id: this.viewId,
                    uid: this.uid,
                    hash: e.view.hash,
                    buffer_id: e.view.id
                }
            },
            success: function() {
                t(this.json.data)
            }
        })
    }
    function r(e, t) {
        e.hpmd = {
            data: {},
            events: {
                add: P.bind(t),
                remove: je.bind(t),
                fire: function(n, i) {
                    "close" !== n ? j.call(t, n, i) : function() {
                        try {
                            e.hpmd.data.destroy()
                        } catch (e) {}
                        if (e.nodes && e.nodes.length)
                            for (var t = 0; t < e.nodes.length; t++)
                                try {
                                    e.nodes[t].parentNode.removeChild(e.nodes[t])
                                } catch (e) {}
                    }()
                }
            },
            getSegment: z.bind(t),
            getSiteId: function() {
                return t.siteId
            },
            getAllocatedTimestamp: function() {
                return e.allocatedTimestamp
            },
            getStylesheet: function() {
                var t = e.nodes[0];
                return t instanceof HTMLStyleElement ? t.sheet : t
            },
            passback: function() {
                He.call(t, e)
            },
            convert: function() {
                F.call(t, e)
            },
            push: ze
        },
            H.call(t, e),
            e.hpmd.registerBid = function(n, i, o) {
                Fe.call(t, e, n, i, o)
            }
        ;
        var n = R.call(t, t.clientConfig)();
        return e.hpmd.getConfig = function() {
            return n
        }
            ,
        t.siteId || (e.hpmd.setSegments = function(e) {
                t.segmentData = e
            }
        ),
        "stories" == e.subformat && (e.hpmd.getStories = function(n) {
                a.call(t, e, n)
            }
                ,
                e.hpmd.getHighlights = function(n) {
                    s.call(t, e, n)
                }
        ),
            e.hpmd
    }
    var l, d, c, u, h, m, p, f, g, v, w, b, y, x, k, S, _, E, C, W, I, P, R, D, L, N, M, O, A, B, T, U, V, H, j, z, F, q, Q, J, X, Y, K, $, G, Z, ee, te, ne, ie, oe, ae, se, re, le, de, ce, ue, he, me, pe, fe, ge, ve, we, be, ye, xe, ke, Se, _e, Ee, Ce, We, Ie, Pe, Re, De, Le, Ne, Me, Oe, Ae, Be, Te, Ue, Ve, He, je, ze, Fe, qe, Qe, Je, Xe, Ye, Ke, $e, Ge, Ze, et, tt, nt, it, ot, at, st, rt, lt, dt, ct, ut, ht = void 0;
    ht = "function" != typeof Object.assign ? function(e) {
            var t, n, i, o;
            if (void 0 === e || null === e)
                throw new TypeError("Cannot convert undefined or null to object");
            for (t = Object(e),
                     n = 1; n < arguments.length; n++)
                if (void 0 !== (i = arguments[n]) && null !== i)
                    for (o in i)
                        i.hasOwnProperty(o) && (t[o] = i[o]);
            return t
        }
        : Object.assign,
        l = ht,
        d = ".hpmdnetwork.ru",
        c = "1",
        u = function(e) {
            return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&")
        }
        ,
        h = function() {
            var e, t = this, n = document.getElementsByTagName("script"), i = new RegExp("^(?:https?:)?//[^/]*" + u(t.domain) + "/client");
            for (e = 0; e < n.length; e++)
                n[e].hasAttribute("src") && n[e].getAttribute("src").match(i) && (t.hpmd_script = n[e])
        }
        ,
        m = function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : window.location.hostname
                , t = this
                , n = 1
                , i = e.split(".").length
                , o = null;
            do {
                if (t.cookieDomain = e.split(".").splice(i - n, i).join("."),
                t.cookieDomain.indexOf(":") && (o = t.cookieDomain + ":" + Math.random()),
                    document.cookie = "hpmd_cd=" + o + "; path=/; domain=" + t.cookieDomain,
                document.cookie.indexOf("hpmd_cd=" + o) > -1)
                    return;
                n++
            } while (n <= i);t.cookieDomain = e
        }
        ,
        p = function(e) {
            var t, n, i = this;
            null !== e && (t = e.getAttribute("src"),
            (n = /client\/(\d+)\.(min\.)?js/.exec(t)) && n[1] && (i.siteId = parseInt(n[1]),
                i.isDemoStand = [50, 51, 52].indexOf(i.siteId) > -1))
        }
        ,
        f = function() {
            var e = this
                , t = /hpmd_user_segments=(\[[\d+,]+\])(;|$)/.exec(document.cookie);
            t && (e.user_segments = JSON.parse(t[1]))
        }
        ,
        g = function(e) {
            var t, n = this;
            n.bodyReadyCallbacks.push(e),
            1 === n.bodyReadyCallbacks.length && (t = function e() {
                    if (document.body) {
                        for (var t = 0; t < n.bodyReadyCallbacks.length; t++)
                            n.bodyReadyCallbacks[t]();
                        n.bodyReadyCallbacks = []
                    } else
                        n.bodyReadyTimeout || (n.bodyReadyTimeout = setTimeout(function() {
                            n.bodyReadyTimeout = null,
                                e()
                        }, 300))
                }
            )()
        }
        ,
        v = function() {
            this.trackingCallbacks.map(function(e) {
                try {
                    e()
                } catch (e) {
                    console && console.error("onUserIdentified(): callback couldn't be executed", e)
                }
            }),
                this.trackingCallbacks = []
        }
        ,
        w = function(e) {
            this.trackingCallbacks.push(e.bind(this))
        }
        ,
        b = function(e, t, n) {
            var i, o = this, a = "";
            n && (a = (i = new Date(Date.now() + 1e3 * n)).toUTCString()),
                document.cookie = e + "=" + t + "; path=/; domain=" + o.cookieDomain + "; expires=" + a
        }
        ,
        y = function(e) {
            this.uid = e,
                b.call(this, "hpmd_uid2", this.uid, 31536e3)
        }
        ,
        x = function() {
            try {
                this.trackingIframe.contentWindow.postMessage("hpmd.setuid" + this.uid, "*")
            } catch (e) {
                console && console.error("HPMD.sendUid(): Cant connect to trackingIframe", e)
            }
        }
        ,
        k = function() {
            var e = this
                , t = /hpmd_uid2=(\d+)(;|$)/.exec(document.cookie);
            t && (e.uid = parseInt(t[1])),
                window.addEventListener("message", function(t) {
                    var n, i;
                    t.origin === e.origin && "string" == typeof t.data && "hpmd.uid" === (n = t.data.substring(0, 8)) && (i = parseInt(t.data.substring(8)),
                    !isNaN(i) && i < e.uid && (e.uid = i),
                    e.uid && (y.call(e, e.uid),
                        w.call(e, x)),
                        v.call(e))
                }),
                e.trackingIframe = document.createElement("iframe"),
                e.trackingIframe.style.cssText = "height:1px;left:-100px;position:absolute;top:-100px;width:1px;",
                e.trackingIframe.setAttribute("src", e.origin + "/track/handler" + e.trackHandlerVersion + ".html"),
                g.call(e, function() {
                    window.document.body.appendChild(e.trackingIframe)
                })
        }
        ,
        S = function(e) {
            var t, n = this;
            e.method || (e.method = "POST"),
            e.url || (e.url = n.protocol + "//banner" + n.domain + "/"),
                e.data ? "string" == typeof e.data ? e.type || (e.type = "application/x-www-form-urlencoded") : (e.data = JSON.stringify(e.data),
                e.type || (e.type = "application/json")) : e.data = "",
                (t = new XMLHttpRequest).open(e.method, e.url, !0),
                t.withCredentials = !0,
            e.type && t.setRequestHeader("Content-Type", e.type),
            e.success && (t.onreadystatechange = function() {
                    if (4 === this.readyState) {
                        try {
                            this.json = JSON.parse(this.responseText)
                        } catch (e) {
                            this.json = null
                        }
                        e.success.call(this)
                    }
                }
            ),
                t.send(e.data)
        }
        ,
        _ = function() {
            var e = this
                , t = void 0
                , n = /hpmd_demo=(\d+)\.([a-f0-9]{40})((\.\w+)+)?/;
            (t = n.exec(location.href) || n.exec(document.cookie)) && (e.demoSettings = {
                banner_id: parseInt(t[1]),
                hash: t[2]
            },
            t[3] && (e.demoSettings.extra = t[3].substring(1, 1e3).split("."))),
                (t = /hpmd_bind_native=([0-3])/.exec(location.href)) ? "0" === t[1] ? b.call(e, "hpmd_bind", "", -86400) : (e.boundNative = parseInt(t[1]),
                    b.call(e, "hpmd_bind", t[1])) : (t = /hpmd_bind=([0-3])/.exec(document.cookie)) && (e.boundNative = parseInt(t[1]))
        }
        ,
        E = function() {
            return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream ? window.screen.height / window.screen.width == 736 / 414 && 3 === window.devicePixelRatio ? "iPhone 6/6S/7/8 Plus" : window.screen.height / window.screen.width == 667 / 375 && 2 === window.devicePixelRatio ? "iPhone 6/6S/7/8" : window.screen.height / window.screen.width == 896 / 414 ? "iPhone XR/XS Max" : window.screen.height / window.screen.width == 812 / 375 ? "iPhone X/XS" : window.screen.height / window.screen.width == 1.775 && 2 === window.devicePixelRatio ? "iPhone 5/5C/5S" : window.screen.height / window.screen.width == 1.5 && 2 === window.devicePixelRatio ? "iPhone 4/4S" : window.screen.height / window.screen.width == 1.5 && 1 === window.devicePixelRatio ? "iPhone 1/3G/3GS" : null : null
        }
        ,
        C = 0,
        W = 2,
        I = 3,
        P = function(e, t) {
            if (void 0 === this.listeners[e])
                throw new Error("HPMD: addEventListener: Unknown event " + e);
            this.listeners[e].push(t)
        }
        ,
        R = function(e) {
            return this.globalEval("(function(hpmd){ " + e + " })")
        }
        ,
        D = function(e) {
            return void 0 === e ? null : e
        }
        ,
        L = function(e, t, n, i) {
            var o = this
                , a = o.protocol + "//banner" + o.domain + "/track/event?uid=" + o.uid + "&dbid=" + o.dbid + "&banner_id=" + e.id + "&view=" + o.viewId + "&event=" + encodeURIComponent(t) + "&redirect_uri=" + encodeURIComponent(n) + "&url=" + encodeURIComponent(location.href.toString())
                , s = D(i);
            return null !== s && (a += "&data=" + encodeURIComponent(JSON.stringify(s))),
                a
        }
        ,
        N = function(e) {
            var t = document.createElement("img");
            t.setAttribute("src", e.replace(/\{RND\}/g, function() {
                return Math.random()
            })),
                t.style.cssText = "position:absolute;left:-10000px;width:1px;height:1px;",
                document.body.appendChild(t)
        }
        ,
        M = function(e, t, n) {
            var i, o, a = this;
            if (S.call(a, {
                forceAsync: !0,
                data: {
                    method: "ad.event",
                    data: {
                        banner_id: e.id,
                        view: a.viewId,
                        uid: a.uid,
                        dbid: a.dbid,
                        event: t,
                        data: D(n)
                    }
                },
                success: function() {}
            }),
            e.pixels && e.pixels[t])
                for (i = e.pixels[t],
                         o = 0; o < i.length; o++)
                    N(i[o])
        }
        ,
        O = function(e, t, n) {
            var i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {}
                , o = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : null
                , a = this
                , s = L.call(a, e, t, n, o);
            null !== a.nw && (i.newWindow = a.newWindow),
                i.newWindow ? window.open(s, i.name ? i.name : null, i.specs ? i.specs : null, i.useReplace) : location.href = s
        }
        ,
        A = function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                , n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null
                , i = this
                , o = void 0;
            e.links && (o = e.links[t]),
            o || (o = "http://www" + i.domain + "/"),
                o = (o = o.replace(/\{RND\}/g, function() {
                    return Math.random()
                })).replace(/\{(\w+)\}/g, function(e) {
                    var t = e.slice(1, -1);
                    return n[t] ? n[t] : ""
                }),
                O.call(i, e, "hpmd.link" + t, o, {
                    newWindow: !0
                })
        }
        ,
        B = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            }
            : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            }
        ,
        T = function(e, t) {
            if (!(e instanceof t))
                throw new TypeError("Cannot call a class as a function")
        }
        ,
        U = function() {
            function e(e, t) {
                var n, i;
                for (n = 0; n < t.length; n++)
                    (i = t[n]).enumerable = i.enumerable || !1,
                        i.configurable = !0,
                    "value"in i && (i.writable = !0),
                        Object.defineProperty(e, i.key, i)
            }
            return function(t, n, i) {
                return n && e(t.prototype, n),
                i && e(t, i),
                    t
            }
        }(),
        V = function(e, t, n) {
            var i = this;
            (function() {
                    var o, a, s;
                    if (function() {
                        return "navigator"in this && "sendBeacon"in this.navigator
                    }
                        .call(this)) {
                        if (o = {
                            method: "ad.event",
                            data: {
                                banner_id: e.id,
                                view: i.viewId,
                                uid: i.uid,
                                dbid: i.dbid,
                                event: t,
                                data: D(n)
                            }
                        },
                            this.navigator.sendBeacon(i.protocol + "//banner" + i.domain + "/", JSON.stringify(o)),
                        e.pixels && e.pixels[t])
                            for (a = e.pixels[t],
                                     s = 0; s < a.length; s++)
                                N(a[s])
                    } else
                        M.call(i, e, t, n)
                }
            ).call("object" === ("undefined" == typeof window ? "undefined" : B(window)) ? window : this || {})
        }
        ,
        H = function(e) {
            var t = this
                , n = []
                , i = []
                , o = [];
            e.hpmd.trackEvent = function(i, o) {
                e.allocated ? M.call(t, e, i, o) : n.push([].slice.call(arguments))
            }
                ,
                e.hpmd.trackEventBeacon = function(i, o) {
                    e.allocated ? V.call(t, e, i, o) : n.push([].slice.call(arguments))
                }
                ,
                e.hpmd.prepareLink = function(n, i, o) {
                    if (!e.allocated)
                        throw new Error("hpmd.banner.link(): this banner has not been initialized yet");
                    L.call(t, e, n, i, o)
                }
                ,
                e.hpmd.trackLink = function(n, o, a, s) {
                    e.allocated ? O.call(t, e, n, o, a, s) : i.push([].slice.call(arguments))
                }
                ,
                e.hpmd.link = function(n, i) {
                    A.call(t, e, n, i)
                }
                ,
                e.hpmd.ready = function(t) {
                    e.allocated ? t() : o.push(t)
                }
                ,
                e.hpmd.asyncPrepareLink = function(t, n, i, o) {
                    e.allocated ? o(e.hpmd.prepareLink.apply(this, [].slice.call(arguments, 0, arguments.length - 1))) : e.hpmd.ready(function() {
                        e.hpmd.asyncPrepareLink.apply(this, [].slice.call(arguments))
                    })
                }
                ,
                e.viewAllocated = function() {
                    var t, a, s;
                    for (t = 0; t < n.length; t++)
                        e.hpmd.trackEvent.apply(this, n[t]);
                    for (a = 0; a < i.length; a++)
                        e.hpmd.trackLink.apply(this, i[a]);
                    for (s = 0; s < o.length; s++)
                        o[s]();
                    n = null,
                        i = null,
                        o = null
                }
                ,
                e.hpmd.firePixel = N
        }
        ,
        j = function(e, t) {
            var n, i = this;
            for (n = 0; n < i.listeners[e].length; n++)
                if (i.listeners[e][n])
                    try {
                        i.listeners[e][n](t)
                    } catch (t) {
                        console && console.error("fireEvent: cannot execute listener for event " + e, t)
                    }
        }
        ,
        z = function(e) {
            return this.segmentData[e]
        }
        ,
        F = function(e) {
            e.hpmd.trackEvent("hpmd.click")
        }
        ,
        q = function(e) {
            if (e)
                try {
                    e.parentNode.removeChild(e)
                } catch (e) {
                    console.log("Provided element wasn't found in DOM")
                }
            else
                console.log("Be sure to pass DOM Element")
        }
        ,
        Q = function(e, t, n) {
            var i = this
                , o = document.createElement("div");
            return o.setAttribute("id", "hpmds-slot-" + n + "-" + t.placement),
                o.classList.add("hpmds-slot"),
            e.onViewportUpdate && (o.onViewportUpdate = e.onViewportUpdate),
                e.element.appendChild(o),
                e.element.style.display = "block",
                e.element.style.visibility = "visible",
            t.auto_size && (o.style.position = "relative",
                o.style.overflow = "hidden",
                o.style.zIndex = "1",
                o.style.paddingTop = "1px",
                o.style.marginTop = "-1px",
                "tablet" === i.segmentData["device_type"] ? (o.style.margin = "auto",
                    o.style.width = window.innerWidth + "px",
                    o.style.maxWidth = .75 * window.innerWidth + "px") : (o.style.marginLeft = window.pageXOffset - o.getBoundingClientRect().left + "px",
                        o.style.marginRight = window.innerWidth - o.getBoundingClientRect().right + window.pageXOffset + "px",
                        o.style.width = window.innerWidth + "px",
                        o.onViewportUpdate = function() {
                            for (var e, t = 0, n = 0, i = o.parentNode, a = function(e, t) {
                                return parseFloat(t.getPropertyValue(e)) || 0
                            }; i && i !== window.document; ) {
                                try {
                                    t += a("padding-left", e = window.getComputedStyle(i)) + a("border-left", e) + a("margin-left", e),
                                        n += a("padding-right", e) + a("border-right", e) + a("margin-right", e)
                                } catch (e) {}
                                i = i.parentNode
                            }
                            o.style.marginLeft = -t + "px",
                                o.style.marginRight = -n + "px"
                        }
                )),
                o
        }
        ,
        J = function(e) {
            var t = []
                , n = !1;
            e.hpmd.playbackReady = function(e) {
                n ? e() : t.push(e)
            }
                ,
                e.setPlaybackReady = function() {
                    n = !0,
                        t.map(function(e) {
                            try {
                                e()
                            } catch (e) {}
                        })
                }
        }
        ,
        X = function(t, n, i) {
            var o = document.createElement("style");
            return o.innerHTML = t,
                document.body.appendChild(o),
                o.sheet.disabled = !0,
                e(o.sheet, n, i),
                o.sheet.disabled = !1,
                o.sheet
        }
        ,
        Y = function() {
            var e = "scrollLeft"in document.documentElement ? "documentElement" : "body"
                , t = {};
            return t.left = document[e].scrollLeft,
                t.top = document[e].scrollTop,
                t.right = t.left + window.innerWidth,
                t.bottom = t.top + window.innerHeight,
                t
        }
        ,
        K = function(e) {
            var t = 0
                , n = 0
                , i = e;
            do {
                t += i.offsetLeft,
                    n += i.offsetTop,
                    i = i.offsetParent
            } while (i);return {
                left: t,
                top: n,
                right: t + e.clientWidth,
                bottom: n + e.clientHeight
            }
        }
        ,
        $ = function(e) {
            S.call(this, {
                forceAsync: !0,
                data: {
                    method: "ad.get",
                    data: {
                        capacity: [e.id],
                        dbid: this.dbid,
                        demo: this.demoSettings,
                        native: 0,
                        positions: [],
                        skip: [],
                        uid: this.uid,
                        user_segments: this.user_segments,
                        view: this.viewId,
                        is_hb: !1
                    }
                },
                success: function() {}
            })
        }
        ,
        G = function(e) {
            var t, n, i, o, a, s = this;
            for (t = 0; t < s.voWatchedBanners.length; t++)
                s.voWatchedBanners[t].allocateView && ("video" === (n = s.voWatchedBanners[t].subformat) && "video-expanding" === n && "in-read" === n || (i = K(s.voWatchedBanners[t].slot),
                e.right >= i.left && e.left <= i.right && e.bottom >= i.top && e.top <= i.bottom && s.voWatchedBanners[t].allocateView()));
            for (o = 0; o < s.voWatchedPositions.length; o++)
                s.voWatchedPositions[o] && !s.voWatchedPositions[o].registered && (a = K(s.voWatchedPositions[o].slot),
                e.right >= a.left && e.left <= a.right && e.bottom >= a.top && e.top <= a.bottom && ($.call(s, s.voWatchedPositions[o]),
                    s.voWatchedPositions[o].registered = !0))
        }
        ,
        Z = function() {
            return this.currentFrame || (this.currentFrame = Y()),
                G.call(this, this.currentFrame)
        }
        ,
        ee = function(e, t) {
            return {
                left: Math.min(e.left, t.left),
                right: Math.max(e.right, t.right),
                top: Math.min(e.top, t.top),
                bottom: Math.max(e.bottom, t.bottom)
            }
        }
        ,
        te = function() {
            var e, t, n, i = this, o = function(e) {
                var t = e.getBoundingClientRect() || {
                    top: -1,
                    bottom: -1,
                    left: -1,
                    right: -1
                };
                return t.left >= 0 && t.right <= window.innerHeight && t.top >= 0 && t.top <= window.innerHeight && t.bottom >= 0 && t.bottom <= window.innerHeight
            };
            for (e = 0; e < i.voWatchedBanners.length; e++)
                i.voWatchedBanners[e].allocateView && ("video" === (t = i.voWatchedBanners[e].subformat) && "video-expanding" === t && "in-read" === t || o(i.voWatchedBanners[e].slot) && i.voWatchedBanners[e].allocateView());
            for (n = 0; n < i.voWatchedPositions.length; n++)
                i.voWatchedPositions[n] && !i.voWatchedPositions[n].registered && o(i.voWatchedPositions[n].slot) && ($.call(i, i.voWatchedPositions[n]),
                    i.voWatchedPositions[n].registered = !0)
        }
        ,
        ne = function() {
            var e = this
                , t = Y()
                , n = e.currentFrame;
            n || (n = Y()),
                t.left === n.left && t.right === n.right && t.top === n.top && t.bottom === n.bottom ? te.call(e) : (G.call(e, ee(n, t)),
                    e.currentFrame = t)
        }
        ,
        ie = function(e) {
            var t, n, i, o, a = this;
            if (e || a.windowWidth !== window.innerWidth) {
                for (a.windowWidth = window.innerWidth,
                         t = a.voWatchedBanners.map(function(e) {
                             return e.slot
                         }),
                         n = 0; n < t.length; n++)
                    t[n].onViewportUpdate && t[n].onViewportUpdate();
                for (i = a.voWatchedBanners,
                         o = 0; o < i.length; o++)
                    i[o].hpmd.data.onViewportUpdate && i[o].hpmd.data.onViewportUpdate()
            }
            ne.call(a)
        }
        ,
        oe = function(e, t) {
            var n, i = this;
            i.voWatchedBanners.push(t),
            t.data && t.data.onViewportUpdate && t.data.onViewportUpdate(),
            i.viewportObservationLaunched || (Z.call(i),
                i.voLaunched = !0,
                i.windowWidth = window.innerWidth,
                n = ie.bind(i),
                setInterval(n, 300),
                window.addEventListener("orientationchange", function() {
                    n(!0)
                }),
                window.addEventListener("resize", n, !1))
        }
        ,
        ae = function(e) {
            for (var t = window.pageXOffset, n = window.pageYOffset, i = t + window.innerWidth, o = n + window.innerHeight, a = e.getUIConfig().height, s = e.container.offsetLeft, r = e.container.offsetTop, l = void 0, d = void 0, c = void 0, u = void 0, h = e.container.offsetParent; h; )
                s += h.offsetLeft,
                    r += h.offsetTop,
                    h = h.offsetParent;
            return l = s + e.container.offsetWidth,
                d = r + a,
                c = (s + l) / 2,
                u = (r + d) / 2,
                r > o || d < n || s > i || l < t ? 0 : u < n || u > o || c < t || c > i ? 1 : s >= t && l <= i && r >= n && d <= o ? 3 : 2
        }
        ,
        se = function(e) {
            var t = ae(e)
                , n = function() {
                var n = {
                    visibility: t
                };
                e.onVisibilityChange && e.onVisibilityChange(n);
                try {
                    e.hpmd.data.onVisibilityChange && e.hpmd.data.onVisibilityChange(n)
                } catch (e) {}
            };
            window.addEventListener("scroll", function() {
                var i = ae(e);
                t !== i && (t = i,
                    n())
            }),
                n()
        }
        ,
        re = function(e, t) {
            "video-expading" === e.subformat || "in-read" === e.subformat ? e.getUIConfig = function() {
                    if (e.expanded)
                        return {
                            height: Math.max(1, t.clientHeight)
                        };
                    var n = void 0;
                    if (e.hpmd.data.ui && "function" == typeof e.hpmd.data.ui.getConfig)
                        try {
                            n = e.hpmd.data.ui.getConfig()
                        } catch (e) {}
                    return "object" !== (void 0 === n ? "undefined" : B(n)) && (n = {}),
                    n.height || (n.height = Math.min(.5625 * t.clientWidth, .6 * window.innerHeight)),
                    n.height > .7 * window.innerHeight && (n.height = .7 * window.innerHeight),
                        n
                }
                : e.getUIConfig = function() {
                    return {
                        height: Math.max(1, t.clientHeight)
                    }
                }
        }
        ,
        le = function(e, t) {
            e.visibility >= 2 && !t.awaitingInitialization ? t.awaitingInitialization = setTimeout(function() {
                delete t.onVisibilityChange,
                    delete t.awaitingInitialization,
                    t.allocateView()
            }, 2e3) : e.visibility < 2 && t.awaitingInitialization && (clearTimeout(t.awaitingInitialization),
                delete t.awaitingInitialization)
        }
        ,
        de = function(e) {
            var t, n;
            switch (e.subformat) {
                case "video":
                    e.onVisibilityChange = function(t) {
                        le(t, e)
                    }
                    ;
                    break;
                case "in-read":
                    t = 0,
                        e.onVisibilityChange = function(n) {
                            n.visibility >= t && (t = n.visibility) >= 3 && e.setPlaybackReady(),
                            n.visibility >= 3 && (setTimeout(function() {
                                e.expanded = !0
                            }, 420),
                                e.allocateView(),
                                delete e.onVisibilityChange)
                        }
                    ;
                    break;
                case "video-expanding":
                    n = 0,
                        e.onVisibilityChange = function(t) {
                            t.visibility > n && (n = t.visibility) >= 3 && (e.setPlaybackReady(),
                                e.expanding = setTimeout(function() {
                                    e.expanded = !0,
                                        delete e.expanding
                                }, 420)),
                            (e.expanding || e.expanded) && le(t, e)
                        }
            }
        }
        ,
        ce = function(e, t) {
            re(e, t),
                de(e),
                se(e),
                oe.call(this, t, e),
                g.call(this, Z.bind(this))
        }
        ,
        ue = function(e) {
            var t = document.createElement("style");
            return t.setAttribute("type", "text/css"),
                t.innerHTML = e,
                document.head.appendChild(t),
                t
        }
        ,
        he = function(e, t) {
            return (t || []).concat([].slice.call(e.querySelectorAll("script")))
        }
        ,
        me = function() {
            var e, t = this, n = t.documentWritePosition.nextSibling;
            try {
                t.documentWritePosition.insertAdjacentHTML("afterend", t.documentWriteBuffer)
            } catch (e) {}
            for (e = t.documentWritePosition.nextSibling; e && n !== e; )
                t.documentWrittenNodes.push(e),
                    e = e.nextSibling;
            t.documentWrittenNodes.length && (t.documentWritePosition = t.documentWrittenNodes[t.documentWrittenNodes.length - 1]),
                t.documentWriteBuffer = ""
        }
        ,
        pe = "loading",
        fe = "interactive",
        ge = "complete",
        ve = function() {
            this.documentWriteBuffer = "",
                this.documentWrittenNodes.map(function(e) {
                    q(e)
                }),
                this.documentWrittenNodes = []
        }
        ,
        we = function(e) {
            var t = this
                , n = document.querySelectorAll("script")
                , i = function(n, i) {
                e ? n.addEventListener(i, ve.bind(t)) : n.removeEventListener(i, ve.bind(t))
            };
            [].map.call(n, function(e) {
                i(e, "load"),
                    i(e, "error")
            })
        }
        ,
        be = function(e) {
            try {
                Object.defineProperty(document, "readyState", {
                    configurable: !0,
                    get: function() {
                        return e
                    }
                })
            } catch (t) {
                document.readyState = e
            }
        }
        ,
        ye = function() {
            var e, t = this;
            document.write = t.originalDocumentWrite,
                document.writeln = t.originalDocumentWriteln,
                document.open = t.originalDocumentOpen,
                document.close = t.originalDocumentClose,
            t.documentComplete && (be(ge),
                (e = document.createEvent("Event")).initEvent("readystatechange", !0, !0),
                document.dispatchEvent(e)),
                t.traversalOverrides.map(function(e) {
                    document[e] = t.documentOriginalMethods[e],
                    Element.prototype[e] && (Element.prototype[e] = t.elementOriginalMethods[e])
                }),
                we.call(t, !1)
        }
        ,
        xe = function() {
            return me.call(this),
                ye.call(this),
                this.documentWrittenNodes
        }
        ,
        ke = function(e, t, n) {
            Ie.call(this, e, n, t, null, !0)
        }
        ,
        Se = function() {
            this.scriptExecutionQueue.length ? (this.scriptExecutionLocked = !0,
                this.scriptExecutionQueue.shift()()) : this.scriptExecutionLocked = !1
        }
        ,
        _e = function(e) {
            if (e)
                try {
                    e.parentNode.removeChild(e)
                } catch (e) {
                    console.log("Provided element wassn't found in DOM")
                }
            else
                console.log("Be sure to pass DOM Element")
        }
        ,
        Ee = function() {
            var e, t, n = this;
            if (document.readyState !== pe)
                return !0;
            try {
                return e = "hpmds-as",
                    n.originalDocumentWrite.call(document, '<ins id="' + e + '"></ins>'),
                !(t = document.getElementById(e)) || (_e(t),
                    !1)
            } catch (e) {
                return !0
            }
        }
        ,
        Ce = function(e) {
            var t, n = this;
            n.documentWritePosition = e,
                n.documentWriteBuffer = "",
                n.documentWrittenNodes = [],
                we.call(n, !0),
                document.write = function(e) {
                    Ee.call(n) ? n.documentWriteBuffer += e : n.originalDocumentWrite.call(document, e)
                }
                ,
                document.writeln = function(e) {
                    document.write(e + "\n")
                }
                ,
                document.open = function() {
                    return this
                }
                ,
                document.close = function() {}
                ,
                n.documentComplete = document.readyState === ge,
            n.documentComplete && be(fe),
                t = function(e) {
                    n.documentOriginalMethods[e] = document[e],
                        document[e] = function() {
                            return me.call(n),
                                n.documentOriginalMethods[e].apply(this, [].slice.call(arguments))
                        }
                        ,
                    Element.prototype[e] && (n.elementOriginalMethods[e] = Element.prototype[e],
                            Element.prototype[e] = function() {
                                return me.call(n),
                                    n.elementOriginalMethods[e].apply(this, [].slice.call(arguments))
                            }
                    )
                }
                ,
                n.traversalOverrides.map(t)
        }
        ,
        We = function(e, t) {
            this.scriptExecutionQueue[t ? "unshift" : "push"](e),
            this.scriptExecutionLocked || Se.call(this)
        }
        ,
        Ie = function(e, n, i, o, a) {
            var s = this
                , r = void 0
                , l = void 0
                , d = document.createElement("div");
            if ("string" == typeof n)
                d.innerHTML = n;
            else
                for (; l = n.shift(); )
                    d.appendChild(l);
            for (r = he(d); d.childNodes.length > 0; )
                l = d.childNodes[0],
                    !0 === a ? (e.parentNode.insertBefore(l, e.nextSibling),
                        e = l) : e.appendChild(l),
                o && o(l);
            t.call(s, r, i, a)
        }
        ,
        Pe = function(e, t) {
            var n;
            t || (t = this.principalBanner),
                n = {
                    exception: e.stack ? {
                        message: e.message,
                        name: e.name,
                        source: {
                            file: e.fileName,
                            line: e.lineNumber,
                            char: e.columnNumber
                        },
                        stack: e.stack
                    } : {
                        name: e.message ? e.message : e.error
                    }
                },
                t.hpmd.trackEvent("hpmd.js-exception", n),
            window.console && console.error("HPMD: banner error", e)
        }
        ,
        Re = function(e, t, n) {
            var i, o = this;
            tt.call(o, C, e),
                i = function() {
                    var i, a, s;
                    o.principalBanner || (o.principalBanner = e),
                        e.nodes = ["native" === e.format ? X(e.css, "#hpmds-slot-" + e.id + "-" + n, "hpmds-slot-kf-" + e.id + "-" + n) : ue(e.css)],
                    "native" === e.format && (e.hpmd.getContainer = function() {
                        return t
                    }
                        ,
                        e.container = t,
                    "video-expanding" !== e.subformat && "in-read" !== e.subformat || J(e)),
                    t && t.onViewportUpdate && t.onViewportUpdate(),
                        i = "native" === e.format ? t : document.body,
                        a = function() {
                            var n = e.initializer || o.pendingInitializer;
                            n && R.call(o, n)(e.hpmd);
                            try {
                                R.call(o, e.js)(e.hpmd)
                            } catch (t) {
                                e.imitation ? e.onException(t) : Pe.call(o, t, e)
                            }
                            "native" === e.format && ce.call(o, e, t)
                        }
                        ,
                        s = function(t) {
                            e.nodes.push(t)
                        }
                        ,
                        Ie.call(o, i, e.html, a, s, !1),
                    "native" === e.format && o.nativeSlots[t.parentElement.id] && (o.nativeSlots[t.parentElement.id].filled = !0)
                }
                ,
                g.call(o, i)
        }
        ,
        De = function(e, t) {
            var n, i, o = this, a = e[0], s = !!a.banner;
            o.demoSettings || (n = e.map(function(e) {
                return {
                    id: e.id,
                    meta: e.meta,
                    mode: e.mode,
                    placement: e.placement,
                    type: e.type
                }
            }),
                j.call(o, "view", {
                    context: t,
                    hasBanner: s,
                    positions: n,
                    uid: o.uid
                }),
            "native" === a.type && j.call(o, "native", {
                container: t.element,
                device_type: o.segmentData["device_type"],
                hasBanner: s,
                placement: a.placement,
                selector: a.meta
            })),
                i = a.banner,
            "line-click" !== a.mode && "scroll" !== a.mode || $.call(o, a),
            i && (i.positions = e,
                i.context = t,
            "native" === a.type && (i.slot = Q.call(o, t, a, i.id)),
            i && !o.firstBanner && (o.firstBanner = i,
                nt.call(o)),
                i.allocateView = function() {
                    i.allocateView = function() {}
                        ,
                        i.allocating = !0,
                    "number" != typeof i.view && (i.allocatedTimestamp = Date.now(),
                        S.call(o, {
                            forceAsync: !0,
                            data: {
                                method: "ad.view",
                                data: {
                                    banner_id: i.id,
                                    buffer_id: i.view.id,
                                    dbid: o.dbid,
                                    demo: !!o.demoSettings || !!o.boundNative,
                                    hash: i.view.hash,
                                    position: i.position,
                                    uid: o.uid,
                                    view_id: o.viewId
                                }
                            },
                            success: function() {
                                !0 === this.json.success && (i.allocating = !1,
                                    i.allocated = !0,
                                    i.viewAllocated())
                            }
                        }))
                }
                ,
            "native" !== i.format && i.allocateView(),
                Re.call(o, i, i.slot, a.placement))
        }
        ,
        Le = function() {
            var e, t = this;
            for (t.isDataReady = !0,
                     e = 0; e < t.dataReadyCallbacks.length; e++)
                try {
                    t.dataReadyCallbacks[e]()
                } catch (t) {
                    console && console.error("HPMD: dataReadyHandler(): cannot execute a callback at index " + e + ".", t)
                }
        }
        ,
        Ne = function(e) {
            this.imitatedFormat && this.imitatedFormat.onUnsupported(e)
        }
        ,
        Me = function(e) {
            return JSON.parse(JSON.stringify(e))
        }
        ,
        Oe = function(e, t, i, o) {
            function a(t, n) {
                S.call(u, {
                    data: {
                        method: "ad.get",
                        data: {
                            capacity: [],
                            dbid: u.dbid,
                            fixed_campaign_id: d,
                            imitate: {
                                format: u.imitatedFormat.format,
                                subformat: u.imitatedFormat.subformat
                            },
                            positions: [t[0].id],
                            skip: [],
                            uid: u.uid,
                            user_segments: u.user_segments,
                            view: u.viewId,
                            is_hb: !1
                        }
                    },
                    success: function() {
                        var t = this.json
                            , o = Me(u.imitatedBanner);
                        o.initializer = t.data.initializer || null,
                            e[0].banner = o,
                            i(o),
                        t.data.unsupported && Ne.call(u),
                        n && n()
                    }
                })
            }
            function s(e) {
                i(null),
                    Ve.call(u, null, null, !0),
                e && e()
            }
            function r(n) {
                var a = e.filter(function(e) {
                    return e.avail
                }).map(function(e) {
                    return e.id
                })
                    , s = o || t && t.skipCapacity ? [] : e.filter(function(e) {
                    return "line-click" !== e.mode && "scroll" !== e.mode && "native" !== e.type
                }).map(function(e) {
                    return e.id
                });
                S.call(u, {
                    forceAsync: "native" === e[0].type,
                    data: {
                        method: "ad.get",
                        data: {
                            capacity: s,
                            dbid: u.dbid,
                            demo: u.demoSettings,
                            fixed_campaign_id: d,
                            native: u.boundNative,
                            positions: a,
                            segments: u.externalSegments,
                            skip: u.campaigns,
                            uid: u.uid,
                            user_segments: u.user_segments,
                            view: u.viewId,
                            is_hb: !1
                        }
                    },
                    success: function() {
                        var o, a = this.json, s = !1;
                        a.success ? (a.data.supported || Ne.call(u),
                            u.pendingInitializer = a.data.initializer,
                            (o = e[0]).banner = a.data.banner || null,
                        o.banner && ("sizmek" === o.banner.subformat && (o.banner.html = o.banner.html.replace("[timestamp]", Date.now()).replace("{RND}", Math.random())),
                            u.campaigns.push(o.banner.cid),
                            u.bannersMap[o.banner.key] = o.banner,
                            s = !0),
                            i(o.banner),
                        o.banner && Le.call(u)) : (u.errorInfo = a,
                        1002 === a.error && (Ne.call(u, !0),
                            Le.call(u))),
                        n && n(),
                        "native" === e[0].type || s || t && "{}" != JSON.stringify(t) || Ve.call(u, null, null, !0)
                    }
                })
            }
            var l, d, c, u = this;
            0 !== e.length && (l = void 0,
                d = top.hpmd.fixed_campaign_id ? top.hpmd.fixed_campaign_id : 0,
                l = u.imitatedFormat ? (c = e.filter(function(e) {
                        return e.type === u.imitatedFormat.format
                    })).length ? function(e) {
                        a(c, e)
                    }
                    : function(e) {
                        s(e)
                    }
                    : function(e) {
                        r(e)
                    }
                ,
                u.positionsQueue.push(l),
            u.positionsQueueActive || n.call(u))
        }
        ,
        Ae = function(e, t) {
            var n = this;
            Oe.call(n, e, t, function() {
                De.call(n, e, t)
            })
        }
        ,
        Be = function(e) {
            var t, n, i = this;
            i.demoSettings || (n = (t = i.positions.filter(function(t) {
                return !(e || !t.default) || !(e.positions && -1 === e.positions.indexOf(t.id) || e.except_format && e.except_format.indexOf(t.type) > -1 || e.formats && -1 === e.formats.indexOf(t.type) || e.format && e.format !== t.type)
            })).filter(function(e) {
                return "native" === e.type && "auto" === e.mode
            }),
            !e.selectors && n.length > 0 && (i.nativeContext = e),
            e.segments && (i.externalSegments = e.segments),
                i.externalSegments && t.length === i.positions.length ? Ve.call(i, null, e) : t.length && Ve.call(i, t.map(function(e) {
                    return e.id
                }), e))
        }
        ,
        Te = function(e) {
            var t, n = this;
            n.documentWatchers.push(e),
                t = function e() {
                    i.call(n),
                        document.removeEventListener("DOMContentLoaded", e),
                        window.removeEventListener("load", e)
                }
                ,
                "loading" !== document.readyState || n.isDocumentWatchersSet ? i.call(n) : (n.isDocumentWatchersSet = !0,
                    document.addEventListener("DOMContentLoaded", t),
                    window.addEventListener("load", t))
        }
        ,
        Ue = function(e, t) {
            var n, i;
            t && (n = this,
                (i = Me(e)).slot = t,
                n.voWatchedPositions.push(i),
                Z.call(n))
        }
        ,
        Ve = function(e, t, n) {
            var i = this;
            e ? o.call(i, i.positions.filter(function(t) {
                return e.indexOf(t.id) > -1
            }), !0, t) : (i.overlayChain.length && o.call(i, i.overlayChain.shift()),
            n || i.positions.filter(function(e) {
                return "native" === e.type
            }).map(function(e) {
                o.call(i, [e])
            }))
        }
        ,
        He = function(e) {
            function t() {
                S.call(o, {
                    data: {
                        method: "ad.passback",
                        data: {
                            uid: o.uid,
                            dbid: o.dbid,
                            view: o.viewId,
                            banner_id: e.id
                        }
                    }
                })
            }
            var n, i, o = this;
            e.allocated ? t() : (n = e.viewAllocated,
                e.viewAllocated = function() {
                    t(),
                    n && n.call(this)
                }
                ,
            e.allocating || e.allocateView()),
            e.slot && q(e.slot),
                e.context.skipCapacity = !0,
                i = e.positions.map(function(e) {
                    return e.id
                }),
                Ve.call(o, i, e.context)
        }
        ,
        je = function(e, t) {
            var n, i = this;
            if (void 0 === i.listeners[e])
                throw new Error("HPMD: removeEventListener: Unknown event " + e);
            for (n = 0; n < i.listeners[e].length; n++)
                i.listeners[e][n] === t && (i.listeners[e][n] = null)
        }
        ,
        ze = function(e) {
            try {
                e()
            } catch (e) {
                window.console && console.log("hpmd: callback error:", e)
            }
        }
        ,
        Fe = function(e, t, n, i) {
            S.call(this, {
                forceAsync: !0,
                data: {
                    method: "ad.tmp.bids",
                    data: {
                        view_id: this.viewId,
                        banner_id: e.id,
                        campaign_id: e.cid,
                        site_id: this.siteId,
                        uid: this.uid,
                        bidder: t,
                        placement: n,
                        cpm: i,
                        dbid: this.dbid,
                        demo: !!this.demoSettings || !!this.boundNative
                    }
                },
                success: function() {}
            })
        }
        ,
        qe = function() {
            function e(t) {
                T(this, e),
                    this.context = t.nativeContext,
                    this.getSegment = z.bind(t),
                    this.getPositions = function() {
                        return t.positions.filter(function(e) {
                            return "native" === e.type && ("auto" === e.mode || "system" === e.mode)
                        })
                    }
                    ,
                    this.slotReady = function(e) {
                        var n, i;
                        t.nativeSlots[e.container.id] || (t.nativeSlots[e.container.id] = e,
                            t.nativeSlots[e.container.id].filled = !1),
                        (n = t.positions.filter(function(t) {
                            return "native" === t.type && ("auto" === t.mode || "system" === t.mode) && t.placement === e.attributes.placement
                        })).length > 0 && (n[0].mode = "system",
                            (i = Me(t.nativeContext) || {}).element = e.container,
                            i.onViewportUpdate = e.onViewportUpdate,
                            t.native_server_side ? n[0].banner && -1 === t.campaigns.indexOf(n[0].banner.cid) && (t.campaigns.push(n[0].banner.cid),
                                De.call(t, n, i)) : (Ue.call(t, n[0], i.element),
                                Ve.call(t, [n[0].id], i)))
                    }
            }
            return U(e, [{
                key: "checkSlots",
                value: function(e) {
                    for (var t in e.nativeSlots)
                        0 == e.nativeSlots[t].filled && this.slotReady(e.nativeSlots[t])
                }
            }]),
                e
        }(),
        Qe = function() {
            this.bypassRequest = !0
        }
        ,
        Je = function(e) {
            this.isDataReady ? e() : this.dataReadyCallbacks.push(e)
        }
        ,
        Xe = function(e) {
            var t = new RegExp("dmp_sync_" + e + "=1").exec(document.cookie);
            return !!t && !!t[0]
        }
        ,
        Ye = function(e) {
            var t = document.createElement("img");
            t.setAttribute("src", "//x01.aidata.io/0.gif?pid=HPMD&id=" + e),
                t.style.cssText = "position:absolute;left:-10000px;width:1px;height:1px",
                document.body.appendChild(t)
        }
        ,
        Ke = function(e) {
            window.adcm_config = {
                id: 1071,
                profileId: "" + e,
                platformId: 71,
                init: function() {
                    window.adcm.call()
                }
            };
            var t = document.createElement("script");
            t.setAttribute("src", "//tag.digitaltarget.ru/adcm.js"),
                t.async = !0,
                document.querySelector("head").appendChild(t)
        }
        ,
        $e = function(e) {
            var t = this
                , n = t.protocol + "//banner" + t.domain + "/dmp/weborama/sync?uid=" + e + "&webouuid={WEBO_CID}"
                , i = document.createElement("img");
            i.setAttribute("src", "//redirect.frontend.weborama.fr/rd?url=" + encodeURIComponent(n)),
                i.style.cssText = "position:absolute;left:-10000px;width:1px;height:1px",
                document.body.appendChild(i)
        }
        ,
        Ge = function(e, t) {
            var n, i, o, a, s, r = this;
            e && (n = 1209600,
                (s = [i = "amberdata", o = "aidata", a = "weborama"]).forEach(function(s) {
                    if (-1 !== t.indexOf(s) && !Xe(s)) {
                        switch (s) {
                            case i:
                                Ke(e);
                                break;
                            case o:
                                Ye(e);
                                break;
                            case a:
                                $e.call(r, e)
                        }
                        b.call(r, "dmp_sync_" + s, "1", n)
                    }
                }))
        }
        ,
        Ze = function(e) {
            function t(e) {
                var t, n, i, o;
                if ("native" === e.type)
                    if (a.native_server_side = !0,
                    "html-markup" === e.mode && (e.mode = "selector",
                        e.meta = ".hpmds-position-" + e.id),
                    "internal-js" === e.mode)
                        t = {
                            requestBanners: function(t) {
                                De.call(a, [e], t)
                            }
                        },
                            Te.call(a, function() {
                                R.call(a, e.meta)(t)
                            });
                    else if (!s.native || "auto" !== e.mode && "system" !== e.mode) {
                        if ("selector" === e.mode)
                            for (i = [].slice.call(document.querySelectorAll(e.meta)),
                                     o = 0; o < i.length; o++)
                                e.already && !e.multi || i[o].querySelector(".hpmds-slot") || -1 === a.campaigns.indexOf(e.banner.cid) && (a.campaigns.push(e.banner.cid),
                                    De.call(a, [e], {
                                        element: i[o]
                                    }),
                                    e.already = !0)
                    } else
                        (n = tt.call(a, W)).checkSlots(a),
                            Te.call(a, function() {
                                R.call(a, a.nativeWrapperPlugin)(n)
                            });
                else
                    "scroll" === e.mode ? window.addEventListener("scroll", function t() {
                        window.pageYOffset > 1.2 * window.innerHeight && (window.removeEventListener("scroll", t),
                            De.call(a, [e], {}))
                    }) : De.call(a, [e], {})
            }
            var n, i, o, a = this, s = e.positions;
            if (a.positions = s.positions,
                a.viewId = s.view,
                a.dbid = s.dbid,
                Ge.call(a, s.uid, s.dmp.send_uid),
                _.call(a),
            (n = s.uid) && y.call(a, n),
                a.segmentData = s.segment || {},
                a.segmentData.site = a.siteId,
            s.config && s.config.site && (a.clientConfig = s.config.site),
                a.nativeWrapperPlugin = s.native || null,
                Array.isArray(e.get.banner))
                s.positions.map(function(n) {
                    e.get.banner.some(function(e) {
                        n.id === e.position && (n.banner = e,
                            t(n))
                    })
                });
            else
                for (i = 0; i < s.positions.length; i++)
                    if ((o = s.positions[i]).id === e.get.banner.position) {
                        o.banner = e.get.banner,
                            t(o);
                        break
                    }
        }
    ,
    et = function e(t) {
        T(this, e),
            this.events = {
                add: P.bind(t),
                remove: je.bind(t),
                fire: j.bind(t)
            },
            this.INITIALIZED = !0,
            this.convert = function(e) {
                t.bannersMap[e] && F.call(t, t.bannersMap[e])
            }
            ,
            this.mute = Qe.bind(t),
            this.passback = function(e) {
                t.bannersMap[e] && He.call(t, t.bannersMap[e])
            }
            ,
            this.push = ze.bind(t),
            this.receive = Ze.bind(t),
            this.requestBanners = Be.bind(t),
            this.nw = function() {
                t.nw = !1
            }
            ,
        t.isDemoStand && (this.registerException = Pe.bind(t),
                this.getBannerInfo = function(e) {
                    Je.call(t, function() {
                        e(t.principalBanner, t.errorInfo)
                    })
                }
                ,
                this.getUid = function() {
                    return t.uid
                }
        )
    }
    ,
    tt = function(e, t) {
        return e === I ? new et(this) : e === C ? r(t, this) : e === W ? new qe(this) : void 0
    }
    ,
    nt = function() {
        var e, t, n = this;
        n._isPublicApiPresented && 1 !== window.hpmd.sync && (window.hpmd && window.hpmd.INITIALIZED || (n.isDemoStand ? (n.firstBanner ? window.hpmd = n.firstBanner.hpmd : n.siteId ? window.hpmd = tt.call(n, I) : window.hpmd = tt.call(n, C, {}),
            n.demoSettings && (window.hpmd.getViewId = function() {
                    return n.firstBanner.viewId
                }
            ),
                window.hpmd.imitate = function(e, t) {
                    n.imitatedBanner = {
                        id: 1,
                        cid: 1,
                        html: e.html,
                        css: e.css,
                        js: e.js,
                        format: e.format,
                        subformat: e.subformat,
                        placement: e.placement,
                        imitation: !0,
                        onException: e.onException,
                        onUnsupported: e.onUnsupported,
                        view: 1
                    },
                    t && t()
                }
                ,
                window.hpmd.imitatePlugins = function(e) {
                    n.nativeWrapperPlugin = e.js
                }
                ,
                window.hpmd.imitateFormat = function(e, t, i) {
                    n.imitatedFormat = {
                        format: e,
                        subformat: t,
                        onUnsupported: i
                    }
                }
        ) : window.hpmd = tt.call(n, I),
            e = function(e) {
                var t, n = ["trackEvent", "trackLink", "prepareLink", "asyncPrepareLink"];
                for (t = 0; t < n.length; t++)
                    window.hpmd[n[t]] = e.hpmd[n[t]]
            }
            ,
        n.boundNative && (n.firstBanner ? e(n.firstBanner) : (t = {
            data: {
                id: 0
            }
        },
            tt.call(n, C, t),
            e(t)),
            window.hpmd.getSegment = z.bind(n))))
    }
    ,
    it = function() {
        var e, t, n = this, i = n.deferredCallbacks;
        if (i.length)
            for (e = 0; e < i.length; e++)
                (t = i[e]) && "string" == typeof t && 0 === t.indexOf("s/") ? n.sectionId = parseInt(t.substring(2, 1e3), 10) : t && "function" == typeof t && ze(t)
    }
    ,
    ot = function() {
        nt.call(this),
            it.call(this)
    }
    ,
    at = function() {
        var e, t, n, i, o = this;
        return null !== o.newSession ? o.newSession : (e = void 0,
            e = !document.referrer || !!(t = /\/\/([^/]+)\//.exec(document.referrer)) && !(n = t[1] === o.cookieDomain || t[1].indexOf("." + o.cookieDomain) === t[1].length - o.cookieDomain.length - 1),
            i = !/hpmd_session=/.exec(document.cookie),
            b.call(o, "hpmd_session", "1", 1800),
            o.newSession = e && i,
            o.newSession)
    }
    ,
    st = function() {
        var e = 2 === this.boundNative ? "-dev.hpmdnetwork.ru" : ".hpmd.local"
            , t = document.createElement("script");
        t.setAttribute("src", "//misc" + e + "/native/debug/merge.js?" + Math.random()),
            document.head.appendChild(t)
    }
    ,
    rt = function(e) {
        b.call(this, "hpmd_user_segments", JSON.stringify(e), 7200)
    }
    ,
    lt = function(e, t) {
        function n(e) {
            var t = e.toLowerCase().match(/[a--]+/g);
            if (null !== t)
                return t = t.join(" ").replace(i, function(e, t, n, i) {
                    return t && i ? " " : ""
                }),
                    {
                        asString: t,
                        asArray: t.split(" ")
                    }
        }
        var i, o, a, s, r, l, d;
        for (t = t || "(-||||||-||||)",
                 i = new RegExp("(^|s+)(" + t + ")(s+|$)","g"),
                 o = [],
                 a = [].slice.call(document.querySelectorAll("title, meta[name=keywords], meta[name=description], h1, h2, h3, h4, h5, h6, img, figcaption")),
                 s = !1,
                 r = function(t) {
                     var i, r, l, d = a[t], c = "";
                     if (!(c = "META" === d.nodeName ? d.getAttribute("content") : "IMG" === d.nodeName && d.getAttribute("alt") ? d.getAttribute("alt") : d.innerText))
                         return "continue";
                     if (!(i = n(c)))
                         return "continue";
                     for (r = function(t) {
                         (s = "string" == typeof e[t] ? i.asArray.some(function(n) {
                             return 0 === n.indexOf(e[t])
                         }) : e[t].every(function(e) {
                             return i.asArray.some(function(t) {
                                 return 0 === t.indexOf(e)
                             })
                         })) && o.push({
                             stop_words: e[t],
                             content: c
                         })
                     }
                              ,
                              l = 0; l < e.length; l++)
                         r(l)
                 }
                 ,
                 l = 0; l < a.length; l++) {
            d = r(l)
        }
        return o.length ? o : null
    }
    ,
    dt = function(e) {
        S.call(this, {
            data: {
                method: "ad.tmp.bs",
                data: {
                    site_id: this.siteId,
                    url: location.href,
                    unsafe_content: e
                }
            }
        })
    }
    ,
    ct = function() {
        var e, t, n = this;
        top.hpmd_ss ? ot.call(n) : (_.call(n),
            e = E.call(n),
            t = function() {
                var e, t, i = this.json;
                i.success ? (i.data.bl.length && null !== (e = lt(i.data.bl)) && e.length && dt.call(n, e),
                    n.positions = i.data.positions,
                    n.viewId = i.data.view,
                    n.dbid = i.data.dbid,
                JSON.stringify(n.user_segments) !== JSON.stringify(i.data.user_segments) && (rt.call(n, i.data.user_segments),
                    f.call(n)),
                i.data.uid && (t = parseInt(i.data.uid, 10),
                (!n.uid || n.uid > t) && y.call(n, t)),
                    n.segmentData = i.data.segment || {},
                    n.segmentData.site = n.siteId,
                i.data.config && i.data.config.site && (n.clientConfig = i.data.config.site),
                    n.nativeWrapperPlugin = i.data.native,
                    Ge.call(n, i.data.uid, i.data.dmp.send_uid)) : n.positions = [],
                    n.positions.map(function(e) {
                        "teaser" !== e.type && "fullscreen" !== e.type || ("auto" === e.mode ? n.overlayChain[0].push(e) : n.overlayChain.push([e]))
                    }),
                n.overlayChain[0].length || n.overlayChain.shift(),
                    ot.call(n),
                (!n.bypassRequest || n.demoSettings || n.boundNative) && Ve.call(n),
                n.boundNative > 1 && st.call(n)
            }
            ,
            S.call(n, {
                data: {
                    method: "ad.positions",
                    data: {
                        demo: !!n.demoSettings || !!n.boundNative,
                        force_model: e,
                        new_session: at.call(n),
                        section_id: n.sectionId,
                        site_id: n.siteId,
                        uid: n.uid,
                        url: location.href,
                        user_segments: n.user_segments
                    }
                },
                success: t
            }))
    }
    ,
    ut = function() {
        function e(t) {
            T(this, e),
                this._assignDefaultValues(),
                this._assignHijackedDocumentWriteProperties(),
                this._assignScrollManagerProperties(),
                l(this, t)
        }
        return U(e, [{
            key: "_assignDefaultValues",
            value: function() {
                this._isPublicApiPresented = !!window.hpmd,
                    this.bannersMap = {},
                    this.bodyReadyCallbacks = [],
                    this.bodyReadyTimeout = null,
                    this.boundNative = 0,
                    this.bypassRequest = !1,
                    this.campaigns = [],
                    this.clientConfig = null,
                    this.cookieDomain = "",
                    this.dataReadyCallbacks = [],
                    this.dbid = null,
                    this.deferredCallbacks = function(e) {
                        return e._isPublicApiPresented ? window.hpmd : []
                    }(this),
                    this.demoSettings = null,
                    this.documentWatchers = [],
                    this.domain = d,
                    this.errorInfo = null,
                    this.externalSegments = null,
                    this.firstBanner = null,
                    this.globalEval = window.eval,
                    this.hpmd_script = null,
                    this.imitatedBanner = null,
                    this.imitatedFormat = null,
                    this.isDataReady = !1,
                    this.isDemoStand = !1,
                    this.isDocumentWatchersSet = !1,
                    this.listeners = {
                        close: [],
                        collapse: [],
                        expand: [],
                        native: [],
                        view: []
                    },
                    this.nativeSlots = {},
                    this.nativeContext = null,
                    this.positionsQueue = [],
                    this.positionsQueueActive = !1,
                    this.nativeWrapperPlugin = null,
                    this.newSession = null,
                    this.origin = "https://banner" + d,
                    this.original_domain = d,
                    this.overlayChain = [[]],
                    this.pendingInitializer = null,
                    this.positions = null,
                    this.principalBanner = null,
                    this.protocol = "https:" === location.protocol ? "https:" : "http:",
                    this.sectionId = null,
                    this.segmentData = {},
                    this.siteId = null,
                    this.trackHandlerVersion = c,
                    this.trackingIframe = null,
                    this.trackingCallbacks = [],
                    this.uid = null,
                    this.user_segments = [],
                    this.viewId = null,
                    this.native_server_side = !1
            }
        }, {
            key: "_assignHijackedDocumentWriteProperties",
            value: function() {
                this.documentComplete = null,
                    this.documentOriginalMethods = {},
                    this.documentWriteBuffer = null,
                    this.documentWritePosition = null,
                    this.documentWrittenNodes = [],
                    this.elementOriginalMethods = {},
                    this.originalDocumentClose = document.close,
                    this.originalDocumentOpen = document.open,
                    this.originalDocumentWrite = document.write,
                    this.originalDocumentWriteln = document.writeln,
                    this.scriptExecutionLocked = !1,
                    this.scriptExecutionQueue = [],
                    this.traversalOverrides = ["getElementsByTagName", "getElementsByTagNameNS", "getElementsByClassName", "querySelector", "querySelectorAll", "getElementById", "getElementsByName"]
            }
        }, {
            key: "_assignScrollManagerProperties",
            value: function() {
                this.currentFrame = null,
                    this.voLaunched = !1,
                    this.voWatchedBanners = [],
                    this.voWatchedPositions = [],
                    this.windowWidth = 0,
                    this.nw = null
            }
        }]),
            e
    }(),
    l(ut.prototype, {
        checkHpmdScript: h,
        detectCookieDomain: m,
        detectSiteId: p,
        detectUserSegments: f,
        initializeUserIdentification: k,
        loadPositions: ct,
        pushTrackingCallbacks: w
    }),
    function(e) {
        if (!e.hpmd_initialized) {
            e.hpmd_initialized = !0;
            var t = new ut;
            e.addEventListener("message", function(n) {
                n.data && n.data.hash && (e.opener.postMessage("success", "*"),
                    b.call(t, "hpmd_demo", n.data.hash, 31536e3),
                    e.location.reload())
            }),
                t.detectCookieDomain(),
                t.checkHpmdScript(),
                t.detectSiteId(t.hpmd_script),
                t.detectUserSegments(),
                t.pushTrackingCallbacks(function() {
                    t.loadPositions()
                }),
                t.initializeUserIdentification(),
                e.addEventListener("scroll", ne.bind(t), !1)
        }
    }(window)
}();